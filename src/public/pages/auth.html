<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Authentication</title>
	</head>
	<body>
		<!-- This is a form to input user data into the DB -->
		<h3>Signup form:</h3>
		<form id="SignupForm">
			<input name="username" placeholder="User name" required />
			<br />
			<input name="password" placeholder="Password" required />
			<br />
			<input name="email" placeholder="Email" required />
			<br />
			<input name="profile_url" placeholder="Profile URL" />
			<br />
			<input name="phone_number" placeholder="Phone number" />
			<br />
			<input name="other_link" placeholder="Other link" />
			<br />
			<button type="submit">Signup</button>
		</form>
		<br />

		<h3>Signin form:</h3>
		<form id="SigninForm">
			<input name="username" placeholder="User name" required />
			<br />
			<input name="password" placeholder="Password" required />
			<br />
			<button type="submit">Signin</button>
		</form>
		<br />
	</body>
	<script defer type="module">
		import { saveToken, getUser } from '../main.js'
		const user = getUser()
		console.log(user)
		document
			.getElementById('SignupForm')
			.addEventListener('submit', async (e) => {
				e.preventDefault()
				const formData = new FormData(e.target)
				const response = await fetch('/api/signup', {
					method: 'POST',
					body: formData,
				})
				if (response.ok) {
					const json = await response.json()
					saveToken(json.token)
					window.location.href = '/'
				}
			})

		document
			.getElementById('SigninForm')
			.addEventListener('submit', async (e) => {
				e.preventDefault()
				const formData = new FormData(e.target)
				const response = await fetch('/api/signin', {
					method: 'POST',
					body: formData,
				})
				if (response.ok) {
					const json = await response.json()
					saveToken(json.token)
					window.location.href = '/'
				}
			})
	</script>
</html>
